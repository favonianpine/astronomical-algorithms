第24章 太阳位置计算

[许剑伟 于家里 2008-3-30下午]

一、低精度计算:

  当计算精度要求为0.01度,计算太阳位置时可假设地球运动是一个纯椭圆，也就说忽略月球及行星摄动,计算表达如下。

  设JD是儒略日数,可以用第7章表述的方法计算。T为J2000起算的儒略世纪数:

    T = (JD-2451545.0)/36525

  计算时要保留足够的小数位数,5位小数是不够的(除非所需的太阳黄经的精度要求不高),注意,T表达为儒略世纪数,所以T误差0.00001相当于0.37日。

  接下来,

  太阳几何平黄经：Lo = 280°.46645 + 36000°.76983*T + 0°.0003032*T^2 （Date平分点起算）

  太阳平近点角: M = 357°.52910 + 35999°.05030*T - 0°.0001559*T^2 -0°.00000048*T^3

  地球轨道离心率： e = 0.016708617 - 0.000042037*T - 0.0000001236*T^2

  太阳中间方程：C = +(1°.914600 - 0°.004817*T -0°.000014*T*T) * sin(M)+(0°.019993 - 0°.000101*T) * sin(2M)+ 0°.000290*sin(3M)

  那么，太阳的真黄经是：Θ = Lo + C

  真近点角是： v = M + C

  日地距离的单位是"天文单位",距离表达为：R = 1.000001018 (1-e^2) / (1+e*cos(v)) ……24.5式

  式中的分子部分的值变化十分缓慢。它的值是:
0.9997190 1800年
0.9997204 1900年
0.9997218 2000年
0.9997232 2100年

  太阳黄经Θ可由上述的方法算出,它是Date黄道分点坐标中的真几何黄经,需通过计算地心坐标星体位置也可算出。

  要取得Date黄道坐标中太阳的视黄经λ，还应对Θ进行章动修正及光行差修正。如果精度要求不高,可用下式修正:

    Ω = 125°.04 - 1934°.136*T
    λ = Θ - 0°.00569 -0°.00478*sin(Ω)

  某此时候,我们需要把太阳黄经转到J2000坐标中,在1900-2100年范围内可利用下式进行: Θ2000 = Θ - 0°.01397*(year-2000)

  如果还想取得更高的转换精度(优于0.01度),那么你可以使用第25章的方法进行坐标旋转。

  Date黄道坐标中的太阳黄纬不超过1".2，如果对精度要求不是很高，可以置0。因此，太阳的地心赤经α及赤纬δ可以用下式(24.6式,24.7式)计算，式中ε是黄赤交角(由21章的21.2式计算)。

  tanα = cosεsinΘ / cosΘ ……24.6式
  sinδ = sinεsinΘ ……24.7式

  如果要想得到太阳的视赤经及赤纬,以上二式中的Θ应换为λ，ε应加上修正量：
    +0.00256*cos(Ω)

[译者注]:实际上就是对Θ补上黄经章动及光行差,ε补上交角章动后再转到赤道坐标中。也可在赤道坐标中补章动及光行差,但公式不同。

  公式24.6当然可以转为：tan(α) = cos(ε)*tan(Θ)，接下来,我们要注意α与Θ应在同一象限。然而,如果你使用计算机语中有ATN2函数(C语言是atan2)，那最好保持24.6式不变，这样就可直接利用ATN2函数算出α,即：α = ATN2( cos(ε)*sin(Θ),cos(Θ) )

例24.a——计算1992-10-13,0点,即力学时TD=JDE 2448908.5时刻的太阳位置。

我们算得:

T = -0.072183436
Lo= -2318°.19281 = 201°.80719
M = -2241°.00604 = 278°.99396
e = 0.016711651
C = -1°.89732
Θ= 199°.90987 = 199°54' 36"
R = 0.99766
Ω= 264°.65
λ= 199°.90897 = 199°54' 32"
εo= 23°26'24".83 = 23°.44023 (由21章的21.2式算得)
ε= 23°.43999
α视= -161°.61918 = +198°.38082 = 13h.225388 = 13h 13m 31s.4
δ视= -7°.78507 = -7°47' 06"

使用VSOP87行星理论计算出的的正确值是：(请与上面的结果做一下比较)
Θ= 199°54' 26".18
λ= 199°54' 21".56
β= +0".72
R = 0.99760853
α视= 13h 13m 30s.749
δ视= -7°47' 01".74

二、高精计算

  在Bretagnon和Simon的书中给出一种计算太阳黄经的方法,其精度可以满足大部分应用.用他们的方法得到0—2800年的精度是0.0006度(2".2),-4000到+8000的精度是0.0009度(3".2),且计算时仅用到49个周期项。

  有一个精度很高的,高达0.01角秒的方法,就是用31章要讲到的VSOP87理论进行计算,但对于地球,该理论用了2425个周期项(1080个黄经周期项,348个黄纬周期项,997个距离周期项)。显然这么的数量无法复制到本书,因此我们只从VSOP87中取出一些主要项(详见附录II),利用它计算得到的太阳位置在-2000到6000年范围内精度是1"。计算步骤如下:

  使用附录II的地球数据,可计算出给定时刻的日心黄经L、黄纬B及距离R,具体详见第31章。别忘了,时间τ是JDE 2451545.0(即J2000.0)起算的儒略千年数,而不是世纪数,最后得到的结果L和B是弧度单位。

  要取得地心黄经Θ及黄纬β,应按下式计算：Θ = L + 180°, β=-B

  转换到FK5系统。太阳黄经Θ及黄纬β是P.Bretagnon的VSOP行星理论定义的动力学黄道坐标。这个参考系与标准的FK5坐标系统(详见20章)仅存在很小的差别。可按以下方法把Θ、β转换到FK5坐标系统中,其中T是J2000起算的儒略世纪数,或T=10τ。

  先计算 λ' = Θ - 1°.397*T - 0°.00031*T^2

  接下来Θ及β的修正量是:
ΔΘ = -0".09033 ……24.9式
Δβ = +0".03916*( cos(λ') - sin(λ') )

仅在需要很精确计算时才进行这个修正。如果使用附录II中提供的被削减了一些项的VSOP87,那么此项修正可省略。

********
  译者注：VSOP动力学的黄道与FK5黄道有一点小差别,所以作以上修正。J2000.0动力学黄道和FK5黄道或赤道可以均可看作惯性系。这两种参考系存在小量差别。J2000.0的VSOP黄道与J2000.0的FK5黄道存在一个很小的夹角 E = 0".0554左右，VSOP黄道经过FK5黄道的升交点为N，N在春风点西侧135度。根据以上说明，易得VSOP的Date黄道与FK5的Date黄道的变换关系：

  Δβ=0.0554*sin(Θ+135-p)，（式中p是Date黄道上的岁差） ……24.E1式
  

  由于两个黄道之间的夹角很小,Δβ也可看作在春分点处两道的垂直距离（看作直线AB），设Date赤道与两黄道交于分别交于A、C，这样三角形ABC直角小三角形，B角是90度，于是有：
    Θ=0时， AB = Δβ = 0".0554*sin(135-p)

  易得两个春风点相差，ΔΘ=AB/tan(ε)

  ε可值为常数23.44度，那么ΔΘ=0".1278*sin(135-p) ……14.E2式

  当计算的时间跨度不大时(如几百年)，p取0即可,那么ΔΘ=0".09035

  实际上,原文的λ' = Θ - p

  代入24.E1式得：Δβ = +0".03916*( cos(λ') - sin(λ') )
**********

  太阳的视位置。到止,我们得到的太阳黄经Θ是Date黄道分点坐标的真几何黄经。要取得视黄经λ,还应加上精确的黄经章动及光行差。

  章动处理：根据第21章算出ΔΨ,并加到Θ中即可。

  太阳地心黄经光行差修正项是: -20".4898/R ……20.10式

  式中R是日地距离(天文单位)。分子是光行差常数(K=20".49552)乘以a*(1-e^2)，与24.5式的分子相同。因此24.10中的分子中其实是一个缓慢变化的数,在0年是20".4893,在+4000年是20".4904。

  但重要的是,24.10式本身不是一个严格的准确的表达式，因为它是假设地球轨道是不受摄动的标准椭圆。当受到摄动是,月球的摄动可引起0".01的误差。

  当需要进行高精度计算时(比使用附录II计算精度要求更高时),可用以下方法进行光行差修正。找个太阳黄经的修正参数Δλ(单位是角秒/日),光行差修正量为:
    -0.005775518*R*Δλ

  式中的R同上述的,是日地距离,单位是天文单位。 常数部分是1个距离单位的光行时间，单位是"日",(=8.3分)。

  在章动与光行差修正之后,我们就得到了太阳的视黄经λ。

  太阳的视黄经λ及视黄纬β可以由12.3式及12.4式转换为视赤经α及视纬δ,式中ε是真黄赤交角,含交角章动Δε。

  太阳的地心黄经修正用的参数Δλ,单位是角秒/日,在J2000黄道坐标中,可由下页的公式计算,式中τ是J2000.0起算的儒略千年数,正弦内的角度的单位是度。

  表达式中,仅保留了几个主要的周期项,因此结果不很严格,但Δλ最多只有0".1误差,用于光行差修正,误差只有0".001。

  如果某些其它应用中,Δλ须是在Date黄道中的,则应把常数项3548.193换为3548.330

Δλ的计算式
J2000坐标, τ是J2000.0起算的儒略千年数, sin()的角度量的单位是度
Δλ = 3548.193
+ 118.568 sin( 87.5287 + 359993.7286τ )
+ 2.476 sin( 85.0561 + 719987.4571τ )
+ 1.376 sin( 27.8502 +4452671.1152τ )
+ 0.119 sin( 73.1375 + 450368.8564τ )
+ 0.114 sin( 337.2264 + 329644.6718τ )
+ 0.086 sin( 222.5400 + 659289.3436τ )
+ 0.078 sin( 162.8136 +9224659.7915τ )
+ 0.054 sin( 82.5823 +1079981.1857τ )
+ 0.052 sin( 171.5189 + 225184.4282τ )
+ 0.034 sin( 30.3214 +4092677.3866τ )
+ 0.033 sin( 119.8105 + 337181.4711τ )
+ 0.023 sin( 247.5418 + 299295.6151τ )
+ 0.023 sin( 325.1526 + 315559.5560τ )
+ 0.021 sin( 155.1241 + 675553.2846τ )
+ 7.311τsin( 333.4515 + 359993.7286τ )
+ 0.305τsin( 330.9814 + 719987.4571τ )
+ 0.010τsin( 328.5170 +1079981.1857τ )
+ 0.309τ^2 sin( 241.4518 + 359993.7286τ )
+ 0.021τ^2 sin( 205.0482 + 719987.4571τ )
+ 0.004τ^2 sin( 297.8610 +4452671.1152τ )
+ 0.010τ^3 sin( 154.7066 + 359993.7286τ )
τ的系数为359993.7、719987或1079981的周期项,与地球离心率相关。
τ的系数为4452671、9224660或4092677的周期项,与月球运动相关。
τ的系数为450369、225184、315560或675553的周期项,与金星摄动相关。
τ的系数为329645、659289、或299296的周期项,与火星摄动相关。

例24.b: 同例24.a一样,计算太阳位置, TD = JDE 2448908.5

使用附录II中的地球数据，计算方法详见第31章,得到：
  L = -43.63484796弧度 = -2500.092628度 = 19.907372度
  B = -0.00000312弧度 = -0.000179度 =-0".644
  R = 0.99760775

由此得:
  Θ= L + 180°= 199°.907372
  β= +0".644

转到FK5坐标系统
  λ' = 200°.01, ΔΘ = -0".09033 = -0°.000025, Δβ = -0".023

由此得:
  Θ = 199°.907347 = 199°54' 26".449, β = +0".62

章动计算(详见21章):
  ΔΨ = +15".908, Δε = -0".308, ε真 = 23°.4401443

由24.10算得光行差修正是:-20".539

因此,太阳的视黄经是:
  λ= Θ + 15".908 - 20".539 = 199°54' 21".818

由12.3及12.4式
  α = 198°.378178 = 13h 13m 30s.763
  δ = -7°.783871 = -7°47' 01".94

最后结果是:
  Θ = 199°54' 26".45 R = 0.99760775
  λ = 199°54' 21".82 α= 13h 13m 30s.763
  β = +0".62 δ= -7°47' 01".74

与例24.a中给出的正确的精确结果比较,这里的结果已经比低度算法好多了。
